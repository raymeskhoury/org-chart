<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!doctype html>
<html>
  <head>
    <!-- <script src="/assets/office-js/office.js"></script> -->
    <!-- <link rel="stylesheet" href="/assets/shoelace/themes/light.css" /> -->
    <script
      src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"
      type="text/javascript"
    ></script>

    <script type="module" src="/taskpane.ts"></script>
    <style>
      :not(:defined) {
        visibility: hidden;
      }
      :root {
        --sl-focus-ring-width: 1px !important;
        --sl-focus-ring-offset: 0px !important;

        --sl-color-primary-50: rgb(249 249 250) !important;
        --sl-color-primary-100: rgb(234 236 239) !important;
        --sl-color-primary-200: rgb(218 222 227) !important;
        --sl-color-primary-300: rgb(201 207 214) !important;
        --sl-color-primary-400: rgb(178 187 197) !important;
        --sl-color-primary-500: rgb(149 161 175) !important;
        --sl-color-primary-600: rgb(118 133 151) !important;
        --sl-color-primary-700: rgb(92 110 131) !important;
        --sl-color-primary-800: rgb(71 91 115) !important;
        --sl-color-primary-900: rgb(41 65 92) !important;
        --sl-color-primary-950: rgb(13 39 71) !important;
        --sl-font-sans: "Inter", sans-serif !important;
        --sl-button-font-size-small: var(--sl-font-size-small) !important;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="toolbar">
        <sl-button size="small" id="updateButton">
          <sl-icon slot="prefix" name="arrow-clockwise"></sl-icon>
          Update
        </sl-button>

        <sl-dropdown id="exportDropdown">
          <sl-button size="small" slot="trigger" caret>
            <sl-icon slot="prefix" name="download"></sl-icon>
            Export
          </sl-button>
          <sl-menu class="menu">
            <sl-menu-item id="exportPng">PNG</sl-menu-item>
            <sl-menu-item id="exportSvg">SVG</sl-menu-item>
            <sl-menu-item id="exportPdf">PDF...</sl-menu-item>
          </sl-menu>
        </sl-dropdown>

        <sl-button size="small" id="printButton">
          <sl-icon slot="prefix" name="printer"></sl-icon>
          Print
        </sl-button>
        <sl-button size="small" id="fitButton">
          <sl-icon slot="prefix" name="arrows-angle-expand"></sl-icon>
          Fit
        </sl-button>
        <sl-button size="small" id="expandButton">
          <sl-icon slot="prefix" name="plus-lg"></sl-icon>
          Expand all
        </sl-button>
      </div>

      <sl-dialog label="Export PDF" id="exportPdfDialog">
        To export to PDF, select "Print" and select "Save as PDF" in your
        browser's print options.
        <sl-button
          slot="footer"
          variant="primary"
          id="exportPdfDialogPrintButton"
          >Print</sl-button
        >
        <sl-button slot="footer" id="exportPdfDialogCloseButton"
          >Close</sl-button
        >
      </sl-dialog>
      <sl-dialog label="Insert template" id="templateDataDialog">
        To get started, insert a template table for entering your org chart
        data. The table will be added at the currently selected cell.
        <div id="templateDataDialogError"></div>
        <sl-button
          slot="footer"
          variant="primary"
          id="templateDataDialogInsertButton"
          >Insert</sl-button
        >
      </sl-dialog>
      <sl-dialog label="Error updating chart" id="chartErrorDialog">
        There is a problem with the data in your chart. Each row should have a
        unique "ID" and a "Manager ID" that corresponds to a unique ID of
        another entry in the data. Exactly one person should have no "ID" which
        indicates they are the head of the organisation.
        <div id="chartErrorDialogMessage"></div>
        <sl-button
          slot="footer"
          variant="primary"
          id="chartErrorDialogRetryButton"
          >Retry</sl-button
        >
      </sl-dialog>

      <div class="chart-container"></div>
    </div>
    <div class="helper-elements">
      <div id="font-resizer"></div>
      <iframe style="visibility: hidden" id="print"></iframe>
    </div>
  </body>
</html>
